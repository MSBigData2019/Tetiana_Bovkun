
# coding: utf-8

# In[19]:


import requests
import unittest
from bs4 import BeautifulSoup

Company = ['LVMH.PA', 'AIR.PA', 'DANO.PA']

url = "https://www.reuters.com/finance/stocks/financial-highlights/"

def _handle_request_result_and_build_soup(request_result):
    if request_result.status_code == 200:
        page_content = request_result.content
        soup = BeautifulSoup(page_content, 'html.parser')
    return soup


def Get_Name(page_url):
    res = requests.get(page_url)
    soup = _handle_request_result_and_build_soup(res)
    Name = soup.find("h1")
    
    return Name.text.strip()

def Get_Quarter_Sales_Result(page_url):
    res = requests.get(page_url)
    soup = _handle_request_result_and_build_soup(res)
    Name = soup.find("h1")
    Data_table = soup.find("table", class_="dataTable")
    [type(item) for item in list(Data_table)]
    Sales_data = Data_table.find_all("td", class_="data")
    [type(item) for item in list(Sales_data)]
    #print (Sales_data[1].text.strip())
    return Sales_data[1].text.strip()

def Get_Action_Price_Changement(page_url):
    res = requests.get(page_url)
    soup = _handle_request_result_and_build_soup(res)
    Name = soup.find("h1")
    #Action_Price = soup.find("div", class_="sectionQuoteDetail")
    Cost_change = soup.find("span", class_="valueContentPercent")
    return (Cost_change.text.strip())

def Get_Action_Price(page_url):
    res = requests.get(page_url)
    soup = _handle_request_result_and_build_soup(res)
    Action_Price_Section = soup.find_all("div", class_="sectionQuoteDetail")
    Action_Price = Action_Price_Section[0].find_all("span")

    return Action_Price[1].text.strip()

def Get_Share_Owned(page_url):
    res = requests.get(page_url)
    soup = _handle_request_result_and_build_soup(res)
    Shares_Section = soup.find_all("tbody", class_="dataSmall")
    Shares_Owned = Shares_Section[-1].find_all("td")

    return Shares_Owned[1].text.strip()

def Dividends_Company(page_url):
    res = requests.get(page_url)
    soup = _handle_request_result_and_build_soup(res)
    All_modules = soup.find_all("div", class_="module")
    Dividend_Section = All_modules[4]
    Dividends = Dividend_Section.find_all("tr", class_="stripe")
    Dividend = Dividends[0].find_all("td", class_="data")
    Dividends_Company=Dividend[0]
    return Dividends_Company.text.strip

def Dividends_Industry(page_url):
    res = requests.get(page_url)
    soup = _handle_request_result_and_build_soup(res)
    All_modules = soup.find_all("div", class_="module")
    Dividend_Section = All_modules[4]
    Dividends = Dividend_Section.find_all("tr", class_="stripe")
    Dividend = Dividends[0].find_all("td", class_="data")
 
    return Dividend[1].text.strip()

def Dividends_Sector(page_url):
    res = requests.get(page_url)
    soup = _handle_request_result_and_build_soup(res)
    All_modules = soup.find_all("div", class_="module")
    Dividend_Section = All_modules[4]
    Dividends = Dividend_Section.find_all("tr", class_="stripe")
    Dividend = Dividends[0].find_all("td", class_="data")
 
    return Dividend[2].text.strip()



for c in Company:
    page_url= url+c
    print(page_url)
    print(Get_Name(page_url))
    print(Get_Quarter_Sales_Result(page_url))
    print(Get_Action_Price(page_url))
    print(Get_Action_Price_Changement(page_url))
    print(Get_Share_Owned(page_url))
    print(Dividends_Company(page_url))
    print(Dividends_Industry(page_url))
    print(Dividends_Sector(page_url))
    

